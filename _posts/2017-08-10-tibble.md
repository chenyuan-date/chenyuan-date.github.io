---
layout: post
title: tibble
author: CY
tags: [R]
categories: [R]
share: false
image:
  background: triangular.png 
---



### 1. `tibble` introduction 

tibble是R语言中一个用来替换data.frame类型的扩展的数据框，tibble继承了data.frame，是弱类型的，同时与data.frame有相同的语法，使用起来更方便。tibble包，也是由Hadley开发的R包。

tibble对data.frame做了重新的设定：

- tibble，不关心输入类型，可存储任意类型，包括list类型

- tibble，没有行名设置 row.names

- tibble，支持任意的列名

- tibble，会自动添加列名

- tibble，类型只能回收长度为1的输入

- tibble，会懒加载参数，并按顺序运行

- tibble，是tbl_df类型

  ​

### 2. `tibble` Installation
```
# The easiest way to get tibble is to install the whole tidyverse:
install.packages("tidyverse")

# Alternatively, install just tibble:
install.packages("tibble")

# Or the the development version from GitHub:
# install.packages("devtools")
devtools::install_github("tidyverse/tibble")
```



### 3. `tibble` usage 

对于tibble包的使用，主要需掌握创建、数据转型、数据查看、数据操作、与data.frame的区别点。复杂的数据处理功能，由dplyr项目来完成

#### 3.1 创建tibble

创建一个tibble类型的data.frame非常简单，语法与传统的data.frame类似。

```r
# 创建一个data.frame
d1 <- data.frame(1:5,b=LETTERS[1:5])
d1 
```

```
##    X1.5 b
## 1      1 A
## 2      2 B
## 3      3 C
## 4      4 D
## 5      5 E
```

```r
# 创建一个tibble类型的data.frame
t1 <- tibble(1:5,b=LETTERS[1:5])
t1
```

```
## # A tibble: 10 x 2
##    `1:5`     b
##     <int> <chr>
##  1      1     A
##  2      2     B
##  3      3     C
##  4      4     D
##  5      5     E
```
从上面的输出可以看到tibble类型，会在输出时多一行，用来指定每一列的类型。

tibble用缩写定义了7种类型：

- int，代表integer

- dbl，代表double

- chr，代表character向量或字符串

- dttm，代表日期+时间(a date + a time)

- lgl，代表逻辑判断TRUE或者FALSE

- fctr，代表因子类型factor

- date，代表日期dates

  ​


查看类型，发现tbl_df继承了tbl继承是data.frame，所以tibble是data.frame的子类型。

```r
class(d1)  # d1为data.frame类型
```

```
## [1] "data.frame"
```

```r
class(t1)  # t1为tbl_df类型
```

```
## [1] "tbl_df"     "tbl"        "data.frame"
```

```r
is.tibble(t1)  # 判断是不是tibble类型
```

```
## [1] TRUE
```

```r
attributes(t1)  # 查看t1的属性
```

```
## $names
## [1] "1:5" "b"   
## 
## $class
## [1] "tbl_df"     "tbl"        "data.frame"
## 
## $row.names
##  [1]  1  2  3  4  5 
```

```r
str(t1)  # 查看t1的静态结构
```

```
## Classes 'tbl_df', 'tbl' and 'data.frame':	5 obs. of  2 variables:
##  $ 1:5: int  1 2 3 4 5
##  $ b   : chr  "A" "B" "C" "D" ...
```

**通过文本排列创建tibble**

```r
# tribble: 智能行(Row-wise)创建tibble
tribble(
~colA, ~colB,
"a",   1,
"b",   2,
"c",   3)
```

```
## # A tibble: 3 x 2
##    colA  colB
##   <chr> <dbl>
## 1     a     1
## 2     b     2
## 3     c     3
```

**通过vector创建tibble**

```r
tibble(letters[1:8])
```

```
## # A tibble: 8 x 1
##   `letters[1:8]`
##            <chr>
## 1              a
## 2              b
## 3              c
## 4              d
## 5              e
## 6              f
## 7              g
## 8              h
```

**通过list创建tibble**

```r
tibble(x = list(diag(1), diag(2)))
```

```
## # A tibble: 2 x 1
##               x
##          <list>
## 1 <dbl [1 x 1]>
## 2 <dbl [2 x 2]>
```

**通过data.frame创建tibble, 或者通过一个tibble创建另一个tibble, 会报错**

```r
tibble(data.frame(1:5))
tibble(x = tibble(1, 2, 3))
```
```
## Error: Column `x` must be a 1d atomic vector or a list
```
tibble其实是存储list类型，这是data.frame做不到的。

**3.2 数据类型转换**

tibble是一个新的类型，R语言中大部分的数据都是基于原有的数据类型，所以原有数据类型与tibble类型的转换就显的非常重要了。

把一个data.frame的类型的转换为tibble类型








### References
[tibble website](https://github.com/tidyverse/tibble)
[R语言数据科学新类型tibble](http://blog.fens.me/r-tibble/)